<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generate Bootstrap Estimates • manymome</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Oxygen_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Bootstrap Estimates">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">manymome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/manymome.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>&lt;Structural Equation Models&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/manymome.html">Moderation, Mediation, Moderated Mediation in Path Models</a></li>
    <li><a class="dropdown-item" href="../articles/med_lav.html">Mediation among Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Multiple Regression&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/med_lm.html">Mediation</a></li>
    <li><a class="dropdown-item" href="../articles/mome_lm.html">Moderated Mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Multigroup Models&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/med_mg.html">Mediation in Multigroup Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Multiple Imputation&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/do_mc_lavaan_mi.html">Monte Carlo Confidence Intervals with Multiple Imputation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Helpers&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/do_boot.html">Generate Bootstrap Estimates</a></li>
    <li><a class="dropdown-item" href="../articles/do_mc.html">Generate Monte Carlo Estimates</a></li>
    <li><a class="dropdown-item" href="../articles/mod_levels.html">Set Moderator Levels</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Technical Appendices&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/get_prod.html">Workflow of `get_prod()` and Friends</a></li>
    <li><a class="dropdown-item" href="../articles/manymome_cond_indirect_and_friends_workflow.html">Workflow of `cond_indirect()`</a></li>
    <li><a class="dropdown-item" href="../articles/manymome_do_boot_workflow.html">Workflow of `do_boot()`</a></li>
    <li><a class="dropdown-item" href="../articles/manymome_do_mc_workflow.html">Workflow of `do_mc()`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/manymome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate Bootstrap Estimates</h1>
                        <h4 data-toc-skip class="author">Shu Fai Cheung
&amp; Sing-Hang Cheung</h4>
            
            <h4 data-toc-skip class="date">2024-09-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/manymome/blob/main/vignettes/do_boot.Rmd" class="external-link"><code>vignettes/do_boot.Rmd</code></a></small>
      <div class="d-none name"><code>do_boot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article is a brief illustration of how to use
<code><a href="../reference/do_boot.html">do_boot()</a></code> from the package <a href="https://sfcheung.github.io/manymome/index.html">manymome</a> (<a href="https://doi.org/10.3758/s13428-023-02224-z" class="external-link">Cheung &amp; Cheung,
2023</a>) to generate bootstrap estimates for
<code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> and <code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>
to form bootstrap confidence intervals.</p>
<p>Although <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> and
<code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code> can also be used to generate
bootstrap estimates when they are called (see
<code><a href="../articles/manymome.html">vignette("manymome")</a></code>), there may be situations in which
users prefer generating the bootstrap estimates first before calling
<code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> and <code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>.
<code><a href="../reference/do_boot.html">do_boot()</a></code> is for this purpose.</p>
</div>
<div class="section level2">
<h2 id="the-workflow">The Workflow<a class="anchor" aria-label="anchor" href="#the-workflow"></a>
</h2>
<p>The following workflow will be demonstrated;</p>
<ol style="list-style-type: decimal">
<li><p>Fit the model as usual.</p></li>
<li><p>Use <code><a href="../reference/do_boot.html">do_boot()</a></code> to generate the bootstrap
estimates.</p></li>
<li><p>Call other functions (e.g, <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> and
<code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>) to compute the desired effects and
form bootstrap confidence intervals.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="demonstration-lavaansem">Demonstration: <code>lavaan::sem()</code><a class="anchor" aria-label="anchor" href="#demonstration-lavaansem"></a>
</h2>
<div class="section level3">
<h3 id="fit-a-model-by-lavaansem">Fit a Model by <code>lavaan::sem()</code><a class="anchor" aria-label="anchor" href="#fit-a-model-by-lavaansem"></a>
</h3>
<p>The data set for illustration:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/manymome/">manymome</a></span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data_med</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x        m        y       c1       c2</span></span>
<span><span class="co">#&gt; 1  9.931992 17.89644 20.73893 1.426513 6.103290</span></span>
<span><span class="co">#&gt; 2  8.331493 17.92150 22.91594 2.940388 3.832698</span></span>
<span><span class="co">#&gt; 3 10.327471 17.83178 22.14201 3.012678 5.770532</span></span>
<span><span class="co">#&gt; 4 11.196969 20.01750 25.05038 3.120056 4.654931</span></span>
<span><span class="co">#&gt; 5 11.887811 22.08645 28.47312 4.440018 3.959033</span></span>
<span><span class="co">#&gt; 6  8.198297 16.95198 20.73549 2.495083 3.763712</span></span></code></pre></div>
<p>It has one predictor (<code>x</code>), one mediator (<code>m</code>),
one outcome variable (<code>y</code>), and two control variables
(<code>c1</code> and <code>c2</code>).</p>
<p>This simple mediation model with two control variables
(<code>c1</code> and <code>c2</code>) will be fitted:</p>
<div class="float">
<img src="do_boot_draw_model-1.png" alt="plot of chunk do_boot_draw_model"><div class="figcaption">plot of chunk do_boot_draw_model</div>
</div>
<p>We first fit the model by <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x + c1 + c2</span></span>
<span><span class="st">y ~ m + x + c1 + c2</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>           fixed.x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           estimator <span class="op">=</span> <span class="st">"MLR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_lavaan</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-18 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                               Standard      Scaled</span></span>
<span><span class="co">#&gt;   Test Statistic                                 0.000       0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0           0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Sandwich</span></span>
<span><span class="co">#&gt;   Information bread                           Observed</span></span>
<span><span class="co">#&gt;   Observed information based on                Hessian</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   m ~                                                 </span></span>
<span><span class="co">#&gt;     x                 0.935    0.075   12.437    0.000</span></span>
<span><span class="co">#&gt;     c1                0.198    0.079    2.507    0.012</span></span>
<span><span class="co">#&gt;     c2               -0.168    0.099   -1.703    0.089</span></span>
<span><span class="co">#&gt;   y ~                                                 </span></span>
<span><span class="co">#&gt;     m                 0.785    0.233    3.363    0.001</span></span>
<span><span class="co">#&gt;     x                 0.508    0.323    1.573    0.116</span></span>
<span><span class="co">#&gt;     c1                0.140    0.188    0.747    0.455</span></span>
<span><span class="co">#&gt;     c2               -0.154    0.214   -0.720    0.471</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   x ~~                                                </span></span>
<span><span class="co">#&gt;     c1                0.026    0.121    0.211    0.833</span></span>
<span><span class="co">#&gt;     c2                0.100    0.084    1.186    0.235</span></span>
<span><span class="co">#&gt;   c1 ~~                                               </span></span>
<span><span class="co">#&gt;     c2               -0.092    0.109   -0.841    0.400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .m                 0.681    0.085    7.976    0.000</span></span>
<span><span class="co">#&gt;    .y                 4.030    0.580    6.944    0.000</span></span>
<span><span class="co">#&gt;     x                 1.102    0.150    7.338    0.000</span></span>
<span><span class="co">#&gt;     c1                1.218    0.161    7.540    0.000</span></span>
<span><span class="co">#&gt;     c2                0.685    0.073    9.340    0.000</span></span></code></pre></div>
<p>Suppose we would like to use robust “sandwich” standard errors and
confidence intervals provided by MLR for the free parameters, but want
to use percentile nonparametric bootstrap confidence interval for the
indirect effect. In the call above, we used
<code>estimator = "MLR"</code> and did not set
<code>se = "boot"</code>.</p>
</div>
<div class="section level3">
<h3 id="generate-bootstrap-estimates">Generate Bootstrap Estimates<a class="anchor" aria-label="anchor" href="#generate-bootstrap-estimates"></a>
</h3>
<p>We can then call <code><a href="../reference/do_boot.html">do_boot()</a></code> on the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> to generate the bootstrap estimates of all
free parameters <em>and</em> the implied statistics, such as the
variances of <code>m</code> and <code>y</code>, which are not free
parameters but are needed to form the confidence interval of the
<em>standardized</em> indirect effect.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/do_boot.html">do_boot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit_lavaan</span>,</span>
<span>                           R <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                           ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                           seed <span class="op">=</span> <span class="fl">58491</span><span class="op">)</span></span></code></pre></div>
<p>Usually, just three arguments are needed:</p>
<ul>
<li><p><code>fit</code>: The output of
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>.</p></li>
<li><p><code>R</code>: The number of bootstrap samples. Should be at
least 2000 or even 5000 in real research. 500 is used here just for
illustration.</p></li>
<li><p><code>ncores</code>: The number of CPU cores to be used in
generating bootstrap estimates in parallel processing.</p></li>
<li><p><code>seed</code>: The seed for the random number generator. To
be used by <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>. It is recommended to set this
argument such that the results are reproducible.</p></li>
</ul>
<p>Parallel processing is enabled by default, and a text progress bar
(generated by the package <code>pbapply</code>) will be displayed. If
<code>ncores</code> is omitted, the number of cores
(<code>ncores</code>) to be used will be decided automatically.
Therefore, users usually do not need to use <code>ncores</code>. It is
set to 1 here just for illustration.</p>
<p>In real research with a complicated model and moderate to large
sample size, even with parallel processing, it may take several minutes,
or even over twenty minutes in some cases. Nevertheless, this only need
to be conducted once in the workflow of <code>manymome</code>.</p>
<p>If bootstrapping takes an appreciable time to run, it is recommended
to save the output using <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code> or
<code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Use saveRDS() ###</span></span>
<span><span class="co"># Save the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">boot_out_lavaan</span>, file <span class="op">=</span> <span class="st">"boot_out_lavaan.rds"</span><span class="op">)</span></span>
<span><span class="co"># Load the output</span></span>
<span><span class="va">boot_out_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"boot_out_lavaan.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Use save() ###</span></span>
<span><span class="co"># Save the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">boot_out_lavaan</span>, file <span class="op">=</span> <span class="st">"boot_out_lavaan.RData"</span><span class="op">)</span></span>
<span><span class="co"># Load the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"boot_out_lavaan.RData"</span><span class="op">)</span></span></code></pre></div>
<p>We recommend <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS()</a></code> although <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code> is
probably a more popular function.</p>
</div>
<div class="section level3">
<h3 id="using-the-output-of-do_boot-in-other-functions-of-manymome">Using the Output of <code>do_boot()</code> in Other Functions of
<code>manymome</code><a class="anchor" aria-label="anchor" href="#using-the-output-of-do_boot-in-other-functions-of-manymome"></a>
</h3>
<p>When calling <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> or
<code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>, the argument <code>boot_out</code>
can be assigned the output of <code>do_bout()</code>. They will then
retrieve he stored bootstrap estimates to form the percentile bootstrap
confidence intervals, if requested.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond_indirect.html">indirect_effect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                              y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                              m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                              fit <span class="op">=</span> <span class="va">fit_lavaan</span>,</span>
<span>                              boot_ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              boot_out <span class="op">=</span> <span class="va">boot_out_lavaan</span><span class="op">)</span></span>
<span><span class="va">out_lavaan</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect  ==</span></span>
<span><span class="co">#&gt;                                      </span></span>
<span><span class="co">#&gt;  Path:               x -&gt; m -&gt; y     </span></span>
<span><span class="co">#&gt;  Indirect Effect:    0.733           </span></span>
<span><span class="co">#&gt;  95.0% Bootstrap CI: [0.270 to 1.228]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computation Formula:</span></span>
<span><span class="co">#&gt;   (b.m~x)*(b.y~m)</span></span>
<span><span class="co">#&gt; Computation:</span></span>
<span><span class="co">#&gt;   (0.93469)*(0.78469)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Percentile confidence interval formed by nonparametric bootstrapping</span></span>
<span><span class="co">#&gt; with 500 bootstrap samples.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients of Component Paths:</span></span>
<span><span class="co">#&gt;  Path Coefficient</span></span>
<span><span class="co">#&gt;   m~x       0.935</span></span>
<span><span class="co">#&gt;   y~m       0.785</span></span></code></pre></div>
<p>Reusing the bootstrap estimates can ensure that all analysis with
bootstrap confidence intervals are based on the same set of bootstrap
samples.</p>
<p>The function also supports bias-corrected (BC) confidence interval,
which can be requested by adding <code>boot_type = "bc"</code> to the
call of <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code>. However, authors in some recent
work do not advocate this method (e.g., Falk &amp; Biesanz, 2015; Hayes,
2022; Tofighi &amp; Kelley, 2020). Therefore, this option is provided
merely for research purpose.</p>
</div>
</div>
<div class="section level2">
<h2 id="demonstration-lm">Demonstration: <code>lm()</code><a class="anchor" aria-label="anchor" href="#demonstration-lm"></a>
</h2>
<div class="section level3">
<h3 id="fit-the-model-by-several-calls-to-lm">Fit the Model by Several Calls to <code>lm()</code><a class="anchor" aria-label="anchor" href="#fit-the-model-by-several-calls-to-lm"></a>
</h3>
<p>Suppose we estimate the parameters using multiple regression. We need
to fit two regression models, one predicts <code>m</code> and the other
predicts <code>y</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit Models</span></span>
<span><span class="va">lm_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">m</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">c1</span> <span class="op">+</span> <span class="va">c2</span>, <span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">lm_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">m</span> <span class="op">+</span> <span class="va">x</span> <span class="op">+</span> <span class="va">c1</span> <span class="op">+</span> <span class="va">c2</span>, <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ###### Regression: Predict m ######</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_m</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = m ~ x + c1 + c2, data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.82810 -0.56016 -0.08481  0.52524  2.09155 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  9.68941    0.91979  10.534   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; x            0.93469    0.08083  11.563   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; c1           0.19778    0.07678   2.576   0.0115 *  </span></span>
<span><span class="co">#&gt; c2          -0.16841    0.10305  -1.634   0.1055    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8425 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.5981, Adjusted R-squared:  0.5855 </span></span>
<span><span class="co">#&gt; F-statistic: 47.62 on 3 and 96 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ###### Regression: Predict y ######</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_y</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ m + x + c1 + c2, data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.1336 -1.3365 -0.1014  1.4597  6.5470 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)   4.4152     3.3016   1.337  0.18432   </span></span>
<span><span class="co">#&gt; m             0.7847     0.2495   3.145  0.00222 **</span></span>
<span><span class="co">#&gt; x             0.5077     0.3057   1.661  0.10004   </span></span>
<span><span class="co">#&gt; c1            0.1405     0.1941   0.724  0.47093   </span></span>
<span><span class="co">#&gt; c2           -0.1544     0.2554  -0.604  0.54695   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.06 on 95 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.3576, Adjusted R-squared:  0.3305 </span></span>
<span><span class="co">#&gt; F-statistic: 13.22 on 4 and 95 DF,  p-value: 1.336e-08</span></span></code></pre></div>
<p>To use <code><a href="../reference/do_boot.html">do_boot()</a></code>, we first combine the regression
outputs to one object using <code><a href="../reference/lm2list.html">lm2list()</a></code>. The output is an
<code>lm_list</code>-class object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lm2list.html">lm2list</a></span><span class="op">(</span><span class="va">lm_m</span>, <span class="va">lm_y</span><span class="op">)</span></span>
<span><span class="va">fit_lm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The models:</span></span>
<span><span class="co">#&gt; m ~ x + c1 + c2</span></span>
<span><span class="co">#&gt; y ~ m + x + c1 + c2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-bootstrap-estimates-1">Generate Bootstrap Estimates<a class="anchor" aria-label="anchor" href="#generate-bootstrap-estimates-1"></a>
</h3>
<p>We can now use <code><a href="../reference/do_boot.html">do_boot()</a></code> as described above, using the
output of <code><a href="../reference/lm2list.html">lm2list()</a></code> instead of the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/do_boot.html">do_boot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit_lm</span>,</span>
<span>                       R <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                       seed <span class="op">=</span> <span class="fl">98715</span>,</span>
<span>                       ncores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Like working on the outputs of <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code>,
parallel processing is also used by default. <code>ncores</code> is the
number of CPU cores to be used. Because the output may not be saved, it
is recommended to set the seed of the random number generation using
<code>seed</code>, set to 98715 in the above example. The seed can be
any integer within the range allowed in R, see <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>.
Setting the seed ensures that the same <code>R</code> set of bootstrap
samples will be generated every time.</p>
</div>
<div class="section level3">
<h3 id="using-the-output-of-do_boot-in-other-functions-of-manymome-1">Using the Output of <code>do_boot()</code> in Other Functions of
<code>manymome</code><a class="anchor" aria-label="anchor" href="#using-the-output-of-do_boot-in-other-functions-of-manymome-1"></a>
</h3>
<p>When calling <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> or
<code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>, we cab set the argument
<code>boot_out</code> to the output of <code>do_bout()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond_indirect.html">indirect_effect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                          y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                          m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                          fit <span class="op">=</span> <span class="va">fit_lm</span>,</span>
<span>                          boot_ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          boot_out <span class="op">=</span> <span class="va">boot_out_lm</span><span class="op">)</span></span>
<span><span class="va">out_lm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect  ==</span></span>
<span><span class="co">#&gt;                                      </span></span>
<span><span class="co">#&gt;  Path:               x -&gt; m -&gt; y     </span></span>
<span><span class="co">#&gt;  Indirect Effect:    0.733           </span></span>
<span><span class="co">#&gt;  95.0% Bootstrap CI: [0.292 to 1.201]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computation Formula:</span></span>
<span><span class="co">#&gt;   (b.m~x)*(b.y~m)</span></span>
<span><span class="co">#&gt; Computation:</span></span>
<span><span class="co">#&gt;   (0.93469)*(0.78469)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Percentile confidence interval formed by nonparametric bootstrapping</span></span>
<span><span class="co">#&gt; with 500 bootstrap samples.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients of Component Paths:</span></span>
<span><span class="co">#&gt;  Path Coefficient</span></span>
<span><span class="co">#&gt;   m~x       0.935</span></span>
<span><span class="co">#&gt;   y~m       0.785</span></span></code></pre></div>
<p>As long as users are aware of the potential problem with
bias-corrected (BC) bootstrap confidence interval (see the references
cited above), <code>boot_type = "bc"</code> can be used to request BC
bootstrap confidence interval instead of the default percentile
bootstrap confidence interval.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-structure-of-the-output">The Structure of the Output<a class="anchor" aria-label="anchor" href="#the-structure-of-the-output"></a>
</h2>
<div class="section level3">
<h3 id="models-fitted-by-lavaansem">Models Fitted by <code>lavaan::sem()</code><a class="anchor" aria-label="anchor" href="#models-fitted-by-lavaansem"></a>
</h3>
<p>The output of <code><a href="../reference/do_boot.html">do_boot()</a></code> in this case is an object of the
class <code>boot_out</code>, which is a list of <code>R</code> lists,
each with three elements: <code>est</code>, <code>implied_stats</code>,
and <code>ok</code>.</p>
<p>This is the content of <code>est</code> of the first list:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lavaan</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">est</span></span>
<span><span class="co">#&gt;    lhs op rhs    est</span></span>
<span><span class="co">#&gt; 1    m  ~   x  0.828</span></span>
<span><span class="co">#&gt; 2    m  ~  c1  0.224</span></span>
<span><span class="co">#&gt; 3    m  ~  c2 -0.231</span></span>
<span><span class="co">#&gt; 4    y  ~   m  1.257</span></span>
<span><span class="co">#&gt; 5    y  ~   x  0.089</span></span>
<span><span class="co">#&gt; 6    y  ~  c1 -0.118</span></span>
<span><span class="co">#&gt; 7    y  ~  c2 -0.632</span></span>
<span><span class="co">#&gt; 8    m ~~   m  0.571</span></span>
<span><span class="co">#&gt; 9    y ~~   y  4.317</span></span>
<span><span class="co">#&gt; 10   x ~~   x  1.207</span></span>
<span><span class="co">#&gt; 11   x ~~  c1  0.146</span></span>
<span><span class="co">#&gt; 12   x ~~  c2  0.115</span></span>
<span><span class="co">#&gt; 13  c1 ~~  c1  1.331</span></span>
<span><span class="co">#&gt; 14  c1 ~~  c2  0.153</span></span>
<span><span class="co">#&gt; 15  c2 ~~  c2  0.688</span></span>
<span><span class="co">#&gt; 16   m r2   m  0.618</span></span>
<span><span class="co">#&gt; 17   y r2   y  0.396</span></span></code></pre></div>
<p>The content is just the first four columns of the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">lavaan::parameterEstimates()</a></code>. Note that only fixed and free
parameters are used so other rows, if any, are not used even if
present.</p>
<p>This is the content of <code>implied_stats</code> of the first
list:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lavaan</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">implied_stats</span></span>
<span><span class="co">#&gt; $cov</span></span>
<span><span class="co">#&gt;         m      y      x     c1     c2</span></span>
<span><span class="co">#&gt; m   1.497                            </span></span>
<span><span class="co">#&gt; y   1.944  7.150                     </span></span>
<span><span class="co">#&gt; x   1.006  1.281  1.207              </span></span>
<span><span class="co">#&gt; c1  0.383  0.241  0.146  1.331       </span></span>
<span><span class="co">#&gt; c2 -0.030 -0.480  0.115  0.153  0.688</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; numeric(0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean_lv</span></span>
<span><span class="co">#&gt; numeric(0)</span></span></code></pre></div>
<p>It has three elements. <code>cov</code> is the implied variances and
covariances of all variables. If a model has latent variables, they will
be included too. The other elements, <code>mean</code> and
<code>mean_lv</code>, are the implied means of the observed variables
and the latent variables (if any), respectively. They are of zero length
if mean structure is not in the fitted model.</p>
<p>The last element, <code>ok</code>, denotes whether the solution in a
bootstrap sample is admissible or not (determined by
<code><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavaan::lavInspect()</a></code> with
<code>what = "post.check"</code>). If not admissible, it will not be
used in forming confidence intervals.</p>
</div>
<div class="section level3">
<h3 id="models-fitted-by-lm">Models Fitted by <code>lm()</code><a class="anchor" aria-label="anchor" href="#models-fitted-by-lm"></a>
</h3>
<p>The output of <code><a href="../reference/do_boot.html">do_boot()</a></code> using the outputs of
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> is identical to that using the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>. It is an object of the class
<code>boot_out</code>, which is a list of <code>R</code> lists, each
with two elements: <code>est</code> and <code>implied_stats</code>.</p>
<p>This is the content of <code>est</code> of the first list:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">est</span></span>
<span><span class="co">#&gt;   lhs op rhs        est</span></span>
<span><span class="co">#&gt; 1   m  ~   x  0.9583396</span></span>
<span><span class="co">#&gt; 2   m  ~  c1  0.2808811</span></span>
<span><span class="co">#&gt; 3   m  ~  c2 -0.3040130</span></span>
<span><span class="co">#&gt; 4   m ~1      9.9351030</span></span>
<span><span class="co">#&gt; 5   y  ~   m  0.3986059</span></span>
<span><span class="co">#&gt; 6   y  ~   x  0.5626298</span></span>
<span><span class="co">#&gt; 7   y  ~  c1  0.5010449</span></span>
<span><span class="co">#&gt; 8   y  ~  c2 -0.3614863</span></span>
<span><span class="co">#&gt; 9   y ~1     11.7212742</span></span></code></pre></div>
<p>The content is similar in structure to the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">lavaan::parameterEstimates()</a></code>. However, the estimates are
the estimates based on <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>.</p>
<p>This is the content of <code>implied_stats</code> of the first
list:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">implied_stats</span></span>
<span><span class="co">#&gt; $cov</span></span>
<span><span class="co">#&gt;             m          x         c1          c2          y</span></span>
<span><span class="co">#&gt; m   1.7489520 0.99463099 0.32168750 -0.15480736  1.4738922</span></span>
<span><span class="co">#&gt; x   0.9946310 1.03034065 0.04418569  0.01709202  0.9921266</span></span>
<span><span class="co">#&gt; c1  0.3216875 0.04418569 1.13244802  0.12743087  0.6744295</span></span>
<span><span class="co">#&gt; c2 -0.1548074 0.01709202 0.12743087  0.68082701 -0.2343517</span></span>
<span><span class="co">#&gt; y   1.4738922 0.99212663 0.67442949 -0.23435172  5.4383227</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;         m         x        c1        c2         y </span></span>
<span><span class="co">#&gt; 18.487194  9.848009  2.329366  5.065314 23.967238</span></span></code></pre></div>
<p>It has two elements. <code>cov</code> is the variances and
covariances of all variables. Unlike the output based on
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>, the content is just the sample variances and
covariances of the variables in each bootstrap sample, generated using
<code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov()</a></code>. The other element, <code>mean</code>, stores sample
means of all variables in each bootstrap sample.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-information">Further Information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h2>
<p>For further information on <code><a href="../reference/do_boot.html">do_boot()</a></code>, please refer to
its help page.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Cheung, S. F., &amp; Cheung, S.-H. (2023). <em>manymome</em>: An R
package for computing the indirect effects, conditional effects, and
conditional indirect effects, standardized or unstandardized, and their
bootstrap confidence intervals, in many (though not all) models.
<em>Behavior Research Methods</em>. <a href="https://doi.org/10.3758/s13428-023-02224-z" class="external-link uri">https://doi.org/10.3758/s13428-023-02224-z</a></p>
<p>Falk, C. F., &amp; Biesanz, J. C. (2015). Inference and interval
estimation methods for indirect effects with latent variable models.
<em>Structural Equation Modeling: A Multidisciplinary Journal,
22</em>(1), 24–38. <a href="https://doi.org/10.1080/10705511.2014.935266" class="external-link uri">https://doi.org/10.1080/10705511.2014.935266</a></p>
<p>Hayes, A. F. (2022). <em>Introduction to mediation, moderation, and
conditional process analysis: A regression-based approach</em> (Third
Edition). The Guilford Press.</p>
<p>Tofighi, D., &amp; Kelley, K. (2020). Indirect effects in sequential
mediation models: Evaluating methods for hypothesis testing and
confidence interval formation. <em>Multivariate Behavioral Research,
55</em>(2), 188–210. <a href="https://doi.org/10.1080/00273171.2019.1618545" class="external-link uri">https://doi.org/10.1080/00273171.2019.1618545</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

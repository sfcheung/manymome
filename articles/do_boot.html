<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="manymome">
<title>Generating Bootstrap Estimates • manymome</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating Bootstrap Estimates">
<meta property="og:description" content="manymome">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">manymome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/manymome.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/med_lav.html">Mediation Models with Latent Variables</a>
    <a class="dropdown-item" href="../articles/mod_levels.html">Setting Moderator Levels</a>
    <a class="dropdown-item" href="../articles/do_boot.html">Generating Bootstrap Estimates</a>
    <a class="dropdown-item" href="../articles/med_lm.html">Mediation Analysis by Multiple Regression</a>
    <a class="dropdown-item" href="../articles/mome_lm.html">Moderated Mediation Analysis by Multiple Regression</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sfcheung/manymome/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="do_boot_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generating Bootstrap Estimates</h1>
                        <h4 data-toc-skip class="author">Shu Fai Cheung &amp; Sing-Hang Cheung</h4>
            
            <h4 data-toc-skip class="date">2022-11-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/manymome/blob/HEAD/vignettes/do_boot.Rmd" class="external-link"><code>vignettes/do_boot.Rmd</code></a></small>
      <div class="d-none name"><code>do_boot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article is a brief illustration of how to use <code><a href="../reference/do_boot.html">do_boot()</a></code> to generate bootstrap estimates for use by <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> and <code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code> to form percentile bootstrap confidence intervals.</p>
<p>Although <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> and <code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code> can also be used to generate bootstrap estimates when they are called (see <code><a href="../articles/manymome.html">vignette("manymome")</a></code>), there may be situations in which users prefer generating the bootstrap estimates first before calling <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> and <code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>. <code><a href="../reference/do_boot.html">do_boot()</a></code> is for this purpose.</p>
</div>
<div class="section level2">
<h2 id="data-set-and-model">Data Set and Model<a class="anchor" aria-label="anchor" href="#data-set-and-model"></a>
</h2>
<p>This data set will be used for illustration:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/manymome/">manymome</a></span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data_med</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x        m        y       c1       c2</span></span>
<span><span class="co">#&gt; 1  9.931992 17.89644 20.73893 1.426513 6.103290</span></span>
<span><span class="co">#&gt; 2  8.331493 17.92150 22.91594 2.940388 3.832698</span></span>
<span><span class="co">#&gt; 3 10.327471 17.83178 22.14201 3.012678 5.770532</span></span>
<span><span class="co">#&gt; 4 11.196969 20.01750 25.05038 3.120056 4.654931</span></span>
<span><span class="co">#&gt; 5 11.887811 22.08645 28.47312 4.440018 3.959033</span></span>
<span><span class="co">#&gt; 6  8.198297 16.95198 20.73549 2.495083 3.763712</span></span></code></pre></div>
<p>It has one predictors (<code>x</code>), one mediator (<code>m</code>), one outcome variable (<code>y</code>), and two control variables (<code>c1</code> and <code>c2</code>).</p>
<p>This simple mediation model with two control variables (<code>c1</code> and <code>c2</code>) will be fitted:</p>
<p><img src="do_boot_files/figure-html/draw_model-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="models-fitted-by-lavaansem">Models Fitted by <code>lavaan::sem()</code><a class="anchor" aria-label="anchor" href="#models-fitted-by-lavaansem"></a>
</h2>
<p>We first fit the model by <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x + c1 + c2</span></span>
<span><span class="st">y ~ m + x + c1 + c2</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>           fixed.x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           estimator <span class="op">=</span> <span class="st">"MLR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_lavaan</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-12 ended normally after 1 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                               Standard      Robust</span></span>
<span><span class="co">#&gt;   Test Statistic                                 0.000       0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0           0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Sandwich</span></span>
<span><span class="co">#&gt;   Information bread                           Observed</span></span>
<span><span class="co">#&gt;   Observed information based on                Hessian</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   m ~                                                 </span></span>
<span><span class="co">#&gt;     x                 0.935    0.075   12.437    0.000</span></span>
<span><span class="co">#&gt;     c1                0.198    0.079    2.507    0.012</span></span>
<span><span class="co">#&gt;     c2               -0.168    0.099   -1.703    0.089</span></span>
<span><span class="co">#&gt;   y ~                                                 </span></span>
<span><span class="co">#&gt;     m                 0.785    0.233    3.363    0.001</span></span>
<span><span class="co">#&gt;     x                 0.508    0.323    1.573    0.116</span></span>
<span><span class="co">#&gt;     c1                0.140    0.188    0.747    0.455</span></span>
<span><span class="co">#&gt;     c2               -0.154    0.214   -0.720    0.471</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   x ~~                                                </span></span>
<span><span class="co">#&gt;     c1                0.026    0.121    0.211    0.833</span></span>
<span><span class="co">#&gt;     c2                0.100    0.084    1.186    0.235</span></span>
<span><span class="co">#&gt;   c1 ~~                                               </span></span>
<span><span class="co">#&gt;     c2               -0.092    0.109   -0.841    0.400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .m                 0.681    0.085    7.976    0.000</span></span>
<span><span class="co">#&gt;    .y                 4.030    0.580    6.944    0.000</span></span>
<span><span class="co">#&gt;     x                 1.102    0.150    7.338    0.000</span></span>
<span><span class="co">#&gt;     c1                1.218    0.161    7.540    0.000</span></span>
<span><span class="co">#&gt;     c2                0.685    0.073    9.340    0.000</span></span></code></pre></div>
<p>Suppose we would like to use robust “sandwich” standard errors and confidence intervals provided by MLR for the free parameters, but want to use percentile nonparametric bootstrap confidence interval for the indirect effect. In the call above, we used <code>estimator = "MLR"</code> and did not set <code>se = "boot"</code>.</p>
<p>We can then call <code><a href="../reference/do_boot.html">do_boot()</a></code> on the output of <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> to generate the bootstrap estimates of all free parameters <em>and</em> the implied statistics, such as the variances of <code>m</code> and <code>y</code>, which are not free parameters but are needed to form the confidence interval of the <em>standardized</em> indirect effect.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/do_boot.html">do_boot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit_lavaan</span>,</span>
<span>                           R <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                           ncores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Usually, just three arguments are needed:</p>
<ul>
<li><p><code>fit</code>: The output of <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>.</p></li>
<li><p><code>R</code>: The number of bootstrap samples. Should be at least 2000 or even 5000 in real research. 100 is used here just for illustration.</p></li>
<li><p><code>ncores</code>: The number of CPU cores to be used in generating bootstrap estimates in parallel processing.</p></li>
</ul>
<p>Parallel processing is enabled by default, and a text progress bar (generated by the package <code>pbapply</code>) will be displayed. If <code>ncores</code> is omitted, the number of cores (<code>ncores</code>) to be used will be decided automatically. Therefore, users usually do not need to use <code>ncores</code>. It is set to 1 here just for illustration.</p>
<p>In real research with a complicated model and moderate to large sample size, even with parallel processing, it may take several minutes, or even over twenty minutes in some cases. Nevertheless, this only need to be conducted once in the workflow of <code>manymome</code>.</p>
<p>If bootstrapping takes an appreciable time to run, it is recommended to save the output using <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code> or <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Use saveRDS() ###</span></span>
<span><span class="co"># Save the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">boot_out_lavaan</span>, file <span class="op">=</span> <span class="st">"boot_out_lavaan.rds"</span><span class="op">)</span></span>
<span><span class="co"># Load the output</span></span>
<span><span class="va">boot_out_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"boot_out_lavaan.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Use save() ###</span></span>
<span><span class="co"># Save the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">boot_out_lavaan</span>, file <span class="op">=</span> <span class="st">"boot_out_lavaan.RData"</span><span class="op">)</span></span>
<span><span class="co"># Load the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"boot_out_lavaan.RData"</span><span class="op">)</span></span></code></pre></div>
<p>We recommend <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS()</a></code> although <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code> is probably a more popular function.</p>
<div class="section level3">
<h3 id="the-structure-of-the-output">The Structure of the Output<a class="anchor" aria-label="anchor" href="#the-structure-of-the-output"></a>
</h3>
<p>The output of <code><a href="../reference/do_boot.html">do_boot()</a></code> in this case is an object of the class <code>boot_out</code>, which is a list of <code>R</code> lists, each with three elements: <code>est</code>, <code>implied_stats</code>, and <code>ok</code>.</p>
<p>This is the content of <code>est</code> of the first list:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lavaan</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">est</span></span>
<span><span class="co">#&gt;    lhs op rhs    est</span></span>
<span><span class="co">#&gt; 1    m  ~   x  0.881</span></span>
<span><span class="co">#&gt; 2    m  ~  c1  0.171</span></span>
<span><span class="co">#&gt; 3    m  ~  c2 -0.220</span></span>
<span><span class="co">#&gt; 4    y  ~   m  0.710</span></span>
<span><span class="co">#&gt; 5    y  ~   x  0.382</span></span>
<span><span class="co">#&gt; 6    y  ~  c1  0.415</span></span>
<span><span class="co">#&gt; 7    y  ~  c2 -0.230</span></span>
<span><span class="co">#&gt; 8    m ~~   m  0.683</span></span>
<span><span class="co">#&gt; 9    y ~~   y  4.137</span></span>
<span><span class="co">#&gt; 10   x ~~   x  1.315</span></span>
<span><span class="co">#&gt; 11   x ~~  c1  0.078</span></span>
<span><span class="co">#&gt; 12   x ~~  c2  0.157</span></span>
<span><span class="co">#&gt; 13  c1 ~~  c1  1.035</span></span>
<span><span class="co">#&gt; 14  c1 ~~  c2  0.024</span></span>
<span><span class="co">#&gt; 15  c2 ~~  c2  0.635</span></span>
<span><span class="co">#&gt; 16   m r2   m  0.604</span></span>
<span><span class="co">#&gt; 17   y r2   y  0.328</span></span></code></pre></div>
<p>The content is just the first four columns of the output of <code><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">lavaan::parameterEstimates()</a></code>.</p>
<p>This is the content of <code>implied_stats</code> of the first list:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lavaan</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">implied_stats</span></span>
<span><span class="co">#&gt; $cov</span></span>
<span><span class="co">#&gt;    m      y      x      c1     c2    </span></span>
<span><span class="co">#&gt; m   1.726                            </span></span>
<span><span class="co">#&gt; y   1.759  6.160                     </span></span>
<span><span class="co">#&gt; x   1.138  1.306  1.315              </span></span>
<span><span class="co">#&gt; c1  0.241  0.625  0.078  1.035       </span></span>
<span><span class="co">#&gt; c2  0.003 -0.074  0.157  0.024  0.635</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; numeric(0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean_lv</span></span>
<span><span class="co">#&gt; numeric(0)</span></span></code></pre></div>
<p>It has three elements. <code>cov</code> is the implied variances and covariances of all variables. If a model has latent variables, they will be included too. The other elements, <code>mean</code> and <code>mean_lv</code>, are the implied means of the observed variables and the latent variables (if any), respectively. They are of zero length if mean structure is not in the fitted model.</p>
<p>The last element, <code>ok</code>, denotes whether the solution in a bootstrap sample is admissible or not (determined by <code><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavaan::lavInspect()</a></code> with <code>what = "post.check"</code>). If not admissible, it will not be used in forming confidence intervals.</p>
</div>
<div class="section level3">
<h3 id="using-the-output-of-do_boot">Using the Output of <code>do_boot()</code><a class="anchor" aria-label="anchor" href="#using-the-output-of-do_boot"></a>
</h3>
<p>When calling <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> or <code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>, the argument <code>boot_out</code> can be assigned the output of <code>do_bout()</code>. They will then retrieve he stored bootstrap estimates to form the bootstrap confidence intervals, if requested.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond_indirect.html">indirect_effect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                              y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                              m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                              fit <span class="op">=</span> <span class="va">fit_lavaan</span>,</span>
<span>                              boot_ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              boot_out <span class="op">=</span> <span class="va">boot_out_lavaan</span><span class="op">)</span></span>
<span><span class="va">out_lavaan</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect ==</span></span>
<span><span class="co">#&gt;                                      </span></span>
<span><span class="co">#&gt;  Path:               x -&gt; m -&gt; y     </span></span>
<span><span class="co">#&gt;  Indirect Effect     0.733           </span></span>
<span><span class="co">#&gt;  95.0% Bootstrap CI: [0.334 to 1.220]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computation Formula:</span></span>
<span><span class="co">#&gt;   (b.m~x)*(b.y~m)</span></span>
<span><span class="co">#&gt; Computation:</span></span>
<span><span class="co">#&gt;   (0.93469)*(0.78469)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Percentile confidence interval formed by nonparametric bootstrapping</span></span>
<span><span class="co">#&gt; with 100 bootstrap samples.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients of Component Paths:</span></span>
<span><span class="co">#&gt;  Path Coefficient</span></span>
<span><span class="co">#&gt;   m~x       0.935</span></span>
<span><span class="co">#&gt;   y~m       0.785</span></span></code></pre></div>
<p>Reusing the bootstrap estimates can ensure that all analysis with bootstrap confidence intervals are based on the same set of bootstrap samples.</p>
</div>
</div>
<div class="section level2">
<h2 id="models-fitted-by-several-calls-to-lm">Models Fitted by Several Calls to <code>lm()</code><a class="anchor" aria-label="anchor" href="#models-fitted-by-several-calls-to-lm"></a>
</h2>
<p>Suppose we estimate the parameters using multiple regression. We need to fit two regression models, one predicts <code>m</code> and the other predicts <code>y</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit Models</span></span>
<span><span class="va">lm_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">m</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">c1</span> <span class="op">+</span> <span class="va">c2</span>, <span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">lm_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">m</span> <span class="op">+</span> <span class="va">x</span> <span class="op">+</span> <span class="va">c1</span> <span class="op">+</span> <span class="va">c2</span>, <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ###### Regression: Predict m ######</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_m</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = m ~ x + c1 + c2, data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.82810 -0.56016 -0.08481  0.52524  2.09155 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  9.68941    0.91979  10.534   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; x            0.93469    0.08083  11.563   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; c1           0.19778    0.07678   2.576   0.0115 *  </span></span>
<span><span class="co">#&gt; c2          -0.16841    0.10305  -1.634   0.1055    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8425 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.5981, Adjusted R-squared:  0.5855 </span></span>
<span><span class="co">#&gt; F-statistic: 47.62 on 3 and 96 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ###### Regression: Predict y ######</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_y</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ m + x + c1 + c2, data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.1336 -1.3365 -0.1014  1.4597  6.5470 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)   4.4152     3.3016   1.337  0.18432   </span></span>
<span><span class="co">#&gt; m             0.7847     0.2495   3.145  0.00222 **</span></span>
<span><span class="co">#&gt; x             0.5077     0.3057   1.661  0.10004   </span></span>
<span><span class="co">#&gt; c1            0.1405     0.1941   0.724  0.47093   </span></span>
<span><span class="co">#&gt; c2           -0.1544     0.2554  -0.604  0.54695   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.06 on 95 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.3576, Adjusted R-squared:  0.3305 </span></span>
<span><span class="co">#&gt; F-statistic: 13.22 on 4 and 95 DF,  p-value: 1.336e-08</span></span></code></pre></div>
<p>To use <code><a href="../reference/do_boot.html">do_boot()</a></code>, we first combine the regression outputs to one object using <code><a href="../reference/lm2list.html">lm2list()</a></code>. The output is an <code>lm_list</code>-class object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lm2list.html">lm2list</a></span><span class="op">(</span><span class="va">lm_m</span>, <span class="va">lm_y</span><span class="op">)</span></span>
<span><span class="va">fit_lm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The models:</span></span>
<span><span class="co">#&gt; m ~ x + c1 + c2</span></span>
<span><span class="co">#&gt; y ~ m + x + c1 + c2</span></span></code></pre></div>
<p>We can now use <code><a href="../reference/do_boot.html">do_boot()</a></code> as described above, using the output of <code><a href="../reference/lm2list.html">lm2list()</a></code> instead of the output of <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/do_boot.html">do_boot</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit_lm</span>,</span>
<span>                       R <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                       seed <span class="op">=</span> <span class="fl">98715</span>,</span>
<span>                       ncores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Like working on the outputs of <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code>, parallel processing is also used by default. <code>ncores</code> is the number of CPU cores to be used. Because the output may not be saved, it is recommended to set the seed of the random number generation using <code>seed</code>, set to 98715 in the above example. The seed can be any integer within the range allowed in R, see <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>. Setting the seed ensures that the same <code>R</code> set of bootstrap samples will be generated every time.</p>
<div class="section level3">
<h3 id="the-structure-of-the-output-1">The Structure of the Output<a class="anchor" aria-label="anchor" href="#the-structure-of-the-output-1"></a>
</h3>
<p>The output of <code><a href="../reference/do_boot.html">do_boot()</a></code> using the outputs of <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> is identical to that using the output of <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>. It is an object of the class <code>boot_out</code>, which is a list of <code>R</code> lists, each with two elements: <code>est</code> and <code>implied_stats</code>.</p>
<p>This is the content of <code>est</code> of the first list:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">est</span></span>
<span><span class="co">#&gt;   lhs op rhs        est</span></span>
<span><span class="co">#&gt; 1   m  ~   x  0.9583396</span></span>
<span><span class="co">#&gt; 2   m  ~  c1  0.2808811</span></span>
<span><span class="co">#&gt; 3   m  ~  c2 -0.3040130</span></span>
<span><span class="co">#&gt; 4   m ~1      9.9351030</span></span>
<span><span class="co">#&gt; 5   y  ~   m  0.3986059</span></span>
<span><span class="co">#&gt; 6   y  ~   x  0.5626298</span></span>
<span><span class="co">#&gt; 7   y  ~  c1  0.5010449</span></span>
<span><span class="co">#&gt; 8   y  ~  c2 -0.3614863</span></span>
<span><span class="co">#&gt; 9   y ~1     11.7212742</span></span></code></pre></div>
<p>The content is similar in structure to the output of <code><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html" class="external-link">lavaan::parameterEstimates()</a></code>. However, the estimates are the estimates based on <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>.</p>
<p>This is the content of <code>implied_stats</code> of the first list:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_out_lm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">implied_stats</span></span>
<span><span class="co">#&gt; $cov</span></span>
<span><span class="co">#&gt;             m          x         c1          c2          y</span></span>
<span><span class="co">#&gt; m   1.7489520 0.99463099 0.32168750 -0.15480736  1.4738922</span></span>
<span><span class="co">#&gt; x   0.9946310 1.03034065 0.04418569  0.01709202  0.9921266</span></span>
<span><span class="co">#&gt; c1  0.3216875 0.04418569 1.13244802  0.12743087  0.6744295</span></span>
<span><span class="co">#&gt; c2 -0.1548074 0.01709202 0.12743087  0.68082701 -0.2343517</span></span>
<span><span class="co">#&gt; y   1.4738922 0.99212663 0.67442949 -0.23435172  5.4383227</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;         m         x        c1        c2         y </span></span>
<span><span class="co">#&gt; 18.487194  9.848009  2.329366  5.065314 23.967238</span></span></code></pre></div>
<p>It has two elements. <code>cov</code> is the variances and covariances of all variables. Unlike the output based on <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>, the content is just the sample variances and covariances of the variables in each bootstrap sample, generated using <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov()</a></code>. The other element, <code>mean</code>, stores sample means of all variables in each bootstrap sample.</p>
</div>
<div class="section level3">
<h3 id="using-the-output-of-do_boot-1">Using the Output of <code>do_boot()</code><a class="anchor" aria-label="anchor" href="#using-the-output-of-do_boot-1"></a>
</h3>
<p>When calling <code><a href="../reference/cond_indirect.html">indirect_effect()</a></code> or <code><a href="../reference/cond_indirect.html">cond_indirect_effects()</a></code>, we cab set the argument <code>boot_out</code> to the output of <code>do_bout()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond_indirect.html">indirect_effect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                          y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                          m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                          fit <span class="op">=</span> <span class="va">fit_lm</span>,</span>
<span>                          boot_ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          boot_out <span class="op">=</span> <span class="va">boot_out_lm</span><span class="op">)</span></span>
<span><span class="va">out_lm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect ==</span></span>
<span><span class="co">#&gt;                                      </span></span>
<span><span class="co">#&gt;  Path:               x -&gt; m -&gt; y     </span></span>
<span><span class="co">#&gt;  Indirect Effect     0.733           </span></span>
<span><span class="co">#&gt;  95.0% Bootstrap CI: [0.277 to 1.206]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computation Formula:</span></span>
<span><span class="co">#&gt;   (b.m~x)*(b.y~m)</span></span>
<span><span class="co">#&gt; Computation:</span></span>
<span><span class="co">#&gt;   (0.93469)*(0.78469)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Percentile confidence interval formed by nonparametric bootstrapping</span></span>
<span><span class="co">#&gt; with 100 bootstrap samples.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients of Component Paths:</span></span>
<span><span class="co">#&gt;  Path Coefficient</span></span>
<span><span class="co">#&gt;   m~x       0.935</span></span>
<span><span class="co">#&gt;   y~m       0.785</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="further-information">Further Information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h2>
<p>For further information on <code><a href="../reference/do_boot.html">do_boot()</a></code>, please refer to its help page.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Shu Fai Cheung, Sing-Hang Cheung.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
